'use strict';

/** @type {import('sequelize-cli').Migration} */
module.exports = {
  async up(queryInterface, Sequelize) {
    // Create an ENUM type
    await queryInterface.sequelize.query(`
CREATE TYPE public.stud_product_type AS ENUM
    ('stud', 'huggies');
    `);

    await queryInterface.createTable("stud_config_products", {
      id: {
        type: Sequelize.BIGINT,
        primaryKey: true,
        allowNull: false,
        autoIncrementIdentity: true,
        autoIncrement: true,
      },
      setting_type: {
        allowNull: false,
        type: Sequelize.BIGINT,
        references: {
          model: 'heads',
          as: 'fk_setting_type',
          key: "id"
        }
      },
      center_dia_wt: {
        allowNull: false,
        type: Sequelize.BIGINT,
        references: {
          model: 'carat_sizes',
          as: 'fk_center_dia_wt',
          key: "id"
        }
      },
      center_dia_shape: {
        allowNull: false,
        type: Sequelize.BIGINT,
        references: {
          model: 'diamond_shapes',
          as: 'fk_center_dia_shape',
          key: "id"
        }
      },
      center_dia_mm_size: {
        allowNull: false,
        type: Sequelize.BIGINT,
        references: {
          model: 'mm_sizes',
          as: 'fk_center_dia_mm_size',
          key: "id"
        }
      },
      center_dia_count: {
        allowNull: false,
        type: Sequelize.BIGINT,
      },
      style_no: {
        allowNull: false,
        type: Sequelize.BIGINT,
      },
      huggies_no: {
        type: Sequelize.BIGINT,
      },
      drop_no: {
        type: Sequelize.BIGINT,
      },
      sort_description: {
        type: 'character varying',
      },
      long_description: {
        type: Sequelize.TEXT,
      },
      labour_charge: {
        type: Sequelize.DOUBLE
      },
      other_charge: {
        type: Sequelize.DOUBLE
      },
      product_total_diamond: {
        type: Sequelize.DOUBLE
      },
      is_active: {
        allowNull: false,
        type: 'bit(1)',
        defaultValue: '1'
      },
      is_deleted: {
        allowNull: false,
        type: 'bit(1)',
        defaultValue: '0'
      },
      created_by: {
        type: Sequelize.BIGINT,
        references: {
          model: 'app_users',
          as: 'fk_created_by',
          key: "id"
        }
      },
      created_at: {
        type: Sequelize.DATE,
      },
      modified_by: {
        type: Sequelize.BIGINT,
        references: {
          model: 'app_users',
          as: 'fk_modified_by',
          key: "id"
        }
      },
      modified_at: {
        type: Sequelize.DATE,
      },
      deleted_by: {
        type: Sequelize.BIGINT,
        references: {
          model: 'app_users',
          as: 'fk_deleted_by',
          key: "id"
        }
      },
      deleted_at: {
        type: Sequelize.DATE,
      },
      product_style: {
        type: "stud_product_type",
        defaultValue: "stud"
      },
      huggies_setting_type: {
        type: Sequelize.BIGINT,
        references: {
          model: 'side_setting_styles',
          as: 'fk_huggies_setting_type',
          key: "id"
        }
      },
      company_info_id: {
        type: Sequelize.INTEGER
      },
      name: {
        type: 'character varying',
      },
      sku: {
        type: 'character varying',
      },
      slug: {
        type: 'character varying',
      }
    });

    await queryInterface.sequelize.query(`
      ALTER TABLE IF EXISTS public.company_infoes
    ALTER COLUMN id SET GENERATED BY DEFAULT;`);
  },

  async down(queryInterface, Sequelize) {
    await queryInterface.dropTable('stud_config_products');
  }
};
